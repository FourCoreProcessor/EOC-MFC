2025-04-13 19:29:15,290 - INFO - Using device: cpu
2025-04-13 19:29:15,290 - INFO - Loading dataset...
2025-04-13 19:29:15,306 - INFO - Found 1779 images for anger
2025-04-13 19:29:15,308 - INFO - Found 1518 images for disgust
2025-04-13 19:29:15,317 - INFO - Found 1709 images for fear
2025-04-13 19:29:15,325 - INFO - Found 3120 images for happy
2025-04-13 19:29:15,328 - INFO - Found 1422 images for neutral
2025-04-13 19:29:15,336 - INFO - Found 1483 images for sad
2025-04-13 19:29:15,340 - INFO - Found 2237 images for surprise
2025-04-13 19:29:15,350 - INFO - Train set size: 10614, Validation set size: 2654
2025-04-13 19:29:15,360 - INFO - Training new CNN model...
2025-04-13 19:29:15,366 - INFO - Starting CNN training with early stopping...
2025-04-13 19:30:24,600 - INFO - Epoch [1/20], Train Loss: 1.5989, Val Loss: 1.2827, Val Acc: 0.4785
2025-04-13 19:30:24,600 - INFO - New best validation loss, saving weights...
2025-04-13 19:31:31,368 - INFO - Epoch [2/20], Train Loss: 1.1335, Val Loss: 1.1267, Val Acc: 0.5708
2025-04-13 19:31:31,368 - INFO - New best validation loss, saving weights...
2025-04-13 19:32:37,715 - INFO - Epoch [3/20], Train Loss: 0.9868, Val Loss: 0.9971, Val Acc: 0.6240
2025-04-13 19:32:37,715 - INFO - New best validation loss, saving weights...
2025-04-13 19:33:44,387 - INFO - Epoch [4/20], Train Loss: 0.8995, Val Loss: 0.9300, Val Acc: 0.6511
2025-04-13 19:33:44,389 - INFO - New best validation loss, saving weights...
2025-04-13 19:41:11,991 - INFO - Epoch [5/20], Train Loss: 0.8487, Val Loss: 0.9034, Val Acc: 0.6571
2025-04-13 19:41:11,991 - INFO - New best validation loss, saving weights...
2025-04-13 19:42:19,556 - INFO - Epoch [6/20], Train Loss: 0.7928, Val Loss: 0.8715, Val Acc: 0.6767
2025-04-13 19:42:19,556 - INFO - New best validation loss, saving weights...
2025-04-13 19:43:27,665 - INFO - Epoch [7/20], Train Loss: 0.7440, Val Loss: 0.8672, Val Acc: 0.6873
2025-04-13 19:43:27,665 - INFO - New best validation loss, saving weights...
2025-04-13 19:44:33,876 - INFO - Epoch [8/20], Train Loss: 0.7041, Val Loss: 0.9274, Val Acc: 0.6707
2025-04-13 19:45:39,822 - INFO - Epoch [9/20], Train Loss: 0.6709, Val Loss: 0.8343, Val Acc: 0.6940
2025-04-13 19:45:39,822 - INFO - New best validation loss, saving weights...
2025-04-13 19:47:59,605 - INFO - Epoch [10/20], Train Loss: 0.6413, Val Loss: 0.8372, Val Acc: 0.6918
2025-04-13 19:49:54,969 - INFO - Epoch [11/20], Train Loss: 0.6098, Val Loss: 0.8468, Val Acc: 0.6933
2025-04-13 19:51:00,472 - INFO - Epoch [12/20], Train Loss: 0.5759, Val Loss: 0.8662, Val Acc: 0.6989
2025-04-13 19:51:00,472 - INFO - Early stopping triggered after 12 epochs.
2025-04-13 19:51:00,472 - INFO - CNN training completed with best weights.
2025-04-13 19:51:00,494 - INFO - Best CNN model saved as cnn_model.pth
2025-04-13 19:51:00,494 - INFO - Extracting CNN features...
2025-04-13 19:51:54,595 - INFO - Extracting HOG features...
2025-04-13 19:52:55,434 - INFO - Combining HOG and CNN features...
2025-04-13 19:52:55,567 - INFO - Combined features shape: (13268, 4036)
2025-04-13 19:52:55,567 - INFO - Fitting new scaler...
2025-04-13 19:52:56,272 - INFO - Feature scaler saved as scaler.pkl
2025-04-13 19:52:56,272 - INFO - Skipping PCA, using normalized combined features directly...
2025-04-13 19:52:56,272 - INFO - Feature shape: (13268, 4036)
2025-04-13 19:52:56,272 - INFO - Training SVM with OvO and hyperparameter tuning...
2025-04-14 05:35:46,111 - INFO - Best SVM parameters: {'estimator__C': 10, 'estimator__gamma': 'auto'}
2025-04-14 05:35:47,524 - INFO - SVM model saved as svm_model.pkl
2025-04-14 05:35:47,524 - INFO - Computing confusion matrix...
2025-04-14 10:07:53,253 - INFO - Confusion Matrix:
[[1778    0    1    0    0    0    0]
 [   0 1518    0    0    0    0    0]
 [   1    0 1706    0    0    2    0]
 [   0    0    0 3120    0    0    0]
 [   0    0    0    0 1422    0    0]
 [   0    0    1    0    0 1482    0]
 [   0    0    0    0    0    1 2236]]
2025-04-14 10:07:53,300 - INFO - Testing image: C:\Users\devis\Documents\academic\s2\eocmfc\test1.jpg
2025-04-14 10:07:53,477 - INFO - Test combined features shape: (4036,)
2025-04-14 10:07:53,478 - INFO - Skipping PCA for test image...
2025-04-14 10:07:53,748 - INFO - Predicted emotion: anger
